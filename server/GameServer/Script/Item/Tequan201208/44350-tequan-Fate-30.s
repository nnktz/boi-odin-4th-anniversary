	//****************************************
	//
	//		Copyright:PERFECT WORLD
	//		Modified:2012/07/15
	//		Author:???(??,??,??)
	//		TaskName:2012?8?????????10???
	//		TaskID:44350-tequan-Fate-30.s
	//
	//****************************************


function OnUseItem(){
  
  $is_rookie = GetPlayerVar(-1, 393)
  
  if $is_rookie == 1
     BC("screen", "player", -1, "You've already received a BOI Rookie Divine Chest. You can only open it once.")
     BC("chat", "player", -1, "You've already received a BOI Rookie Divine Chest. You can only open it once.")
     return
  endif
  	
  	$MC_used = GetPlayerVar(-1,389)
		if $MC_used == 1
			BC("screen","player",-1,"You can only use once.")
			BC("chat", "player", -1, "You can only use once.")
			return
		endif
 
          
  //??????,???30????????
  $level = GetPlayerInfo( -1, "level" )
  if $level < 30
     BC( "screen", "player", -1, "You must reach LV30 before you can use this Divine Deity Chest!" )
     BC( "chat", "player", -1, "You must reach LV30 before you can use this Divine Deity Chest!" )
     return
  endif
  
  //???????,30??????4???,?????????1
  $bag_count = GetPlayerInfo( -1, "nullitem", 0 )
  if $bag_count < 4
     BC( "screen", "player", -1, "Not enough space in your bag. Please clear some space to open the Divine Deity Chest!" )
     BC( "chat", "player", -1, "Not enough space in your bag. Please clear some space to open the Divine Deity Chest!" )
     return
  endif

  //???????
  $del_count = SubPlayerInfo( -1, "item", 44350, 1 )
  //??????????,????????
  if $del_count != 0
     return
  endif

  //???????????,???????3381?
  //??1??17173,2????,3????,4????,5????,6????,7????
  //2012?4?--??11??17173,12??????,13??????,14??????,15????,16????,17????,18????,19??360
  //???2012?17173,??11
  SetPlayerVar(-1, 393, 1)

  //---------?????????------------
  
  //?????????
  AddPlayerInfo(-1, "item", 44351, 1 ) 
  
  //????,??????Buff
  PlayEffect(-1, "common\Yanhua\tx_liuxingyu\tx_liuxingyu.ini" )
  AddStatus(-1, 7583, 1 )
  
  //???? ???? 36989 ALL + 15  ???? ? 36995   ? 36996  ???????  6460  ??????? 6464
  AddPlayerInfo(-1,"item",36989,1)
  AddPlayerInfo(-1,"item",6460,1)
  AddPlayerInfo(-1,"item",6464,1)
  //??????,??????,0??,1??
  $gender = GetPlayerInfo( -1, "sex" )
  if $gender == 0
     AddPlayerInfo(-1, "item", 36995, 1)
  else 
     AddPlayerInfo(-1, "item", 36996, 1)
  endif

}